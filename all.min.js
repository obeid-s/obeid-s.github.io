class t{constructor(t,e){this.smallCanvas=new a(t,e);var i=document.getElementById(t),s=i.clientWidth,r=i.clientHeight,n=i.parentElement;i.remove(),this.canvas=document.createElement("canvas"),this.canvas.id=t,this.canvas.className="main-canvas",this.canvas.width=s,this.canvas.height=r,n.appendChild(this.canvas),this.offsetX=25,this.offsetY=25,this.xPosAt=0,this.stepsX=0,this.isTranslateCenter=!1,this.ctx=this.canvas.getContext("2d"),this.titleText=e,this.data=new Array(2),this.subscribeData=new Array(2),this.currentIndexAt=new Array(2),this.startMetersIndex=0,this.endMetersIndex=0,this.lineColorMainData="rgb(72, 109, 232)",this.lineColorComparedData="rgb(197, 83, 5)",this.fillColorMainData="rgba(72, 109, 232, 0.3)",this.fillColorComparedData="rgba(197, 83, 5, 0.3)",this.lineWidth=1.2,this.boxWidth=38,"Speed"==this.titleText&&(this.boxWidth=54),"Gear"==this.titleText&&(this.boxWidth=22),this.dataMinMax={oldMin:99999,oldMax:-99999,newMin:99999,newMax:-99999}}clear(){this.data=new Array(2),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.closePath(),this.startMetersIndex=0,this.endMetersIndex=0}setLap(t,e){t>=2?console.log("Error: You Cannot Set More Than 2 data Laps!"):(this.data[t]=e,this.startMetersIndex=0,this.endMetersIndex=null!=this.data[0]?this.data[0].length:this.data[1].length)}setSubscribeData(t,e){t>=2?console.log("Error: You Cannot Set More Than 2 data Laps!"):this.subscribeData[t]=e}setMinMaxData(t,e,i,a){this.dataMinMax.oldMin>t&&(this.dataMinMax.oldMin=t),this.dataMinMax.oldMax<e&&(this.dataMinMax.oldMax=e),this.dataMinMax.newMin>i&&(this.dataMinMax.newMin=i),this.dataMinMax.newMax<a&&(this.dataMinMax.newMax=a)}setStartEndIndex(t,e){this.startMetersIndex=t,this.endMetersIndex=e,this.draw()}setIsTranslateCenter(t){this.isTranslateCenter=t}getCanvas(){return this.canvas}getCurrentIndexAt(t){return this.currentIndexAt[t]}getOffsetX(){return this.offsetX}getOffsetY(){return this.offsetY}drawTextTitle(){this.ctx.font="bold 26px Arial",this.ctx.fillStyle="rgba(130, 17, 49, 0.5)",this.ctx.fillText(this.titleText,25,25)}drawBaseLines(){this.ctx.strokeStyle="rgba(255, 255, 255, 0.1)";var t=(this.canvas.height-this.offsetY)/4;this.ctx.beginPath();for(var e=t;e<this.canvas.height;e+=t)this.ctx.moveTo(this.offsetX,e),this.ctx.lineTo(this.canvas.width,e);this.ctx.stroke(),this.ctx.strokeStyle="rgba(255, 255, 255, 0.8)",this.ctx.beginPath(),this.ctx.moveTo(this.offsetX,5),this.ctx.lineTo(this.offsetX,this.canvas.height-this.offsetY),this.ctx.stroke()}drawCircleOnHoveredPoint(t){this.ctx.beginPath(),this.ctx.fillStyle=0==t?this.lineColorMainData:this.lineColorComparedData;var e=this.currentIndexAt[t],i=-(this.canvas.height-(this.offsetY+5));this.isTranslateCenter&&(i/=2);var a=0;a="CFSRideHeight"==this.titleText||"Left front"==this.titleText||"Right front"==this.titleText||"Left rear"==this.titleText||"Right rear"==this.titleText?i*((this.dataMinMax.newMax-this.dataMinMax.newMin)*(this.data[t][e]-this.dataMinMax.oldMin)/(this.dataMinMax.oldMax-this.dataMinMax.oldMin)+this.dataMinMax.newMin):this.data[t][e]*i,this.ctx.arc(this.xPosAt+this.offsetX,a,4,0,2*Math.PI),this.ctx.fill()}drawBoxData(t){var e=this.currentIndexAt[t];this.ctx.beginPath(),this.ctx.fillStyle=0==t?this.lineColorMainData:this.lineColorComparedData;var i=this.xPosAt+this.offsetX;i>this.canvas.width/2&&(i-=this.boxWidth);var a=-this.canvas.height/2;this.isTranslateCenter&&(a=0),1==t&&(a+=16),this.ctx.fillRect(i,a,this.boxWidth,14),this.ctx.beginPath(),this.ctx.font="bold 12px Arial",this.ctx.fillStyle="rgba(255, 255, 255, 1.0)";var s=this.extractOriginData(t,e);this.ctx.fillText(s,i+2,a+12)}extractOriginData(t,e){switch(this.titleText){case"Delta":return null!=this.data[t][e]?this.data[t][e].toFixed(2)+"s":"0.00s";case"Throttle":case"Brake":return(100*this.data[t][e]).toFixed(0)+"%";case"Gear":return Math.round(8*this.data[t][e]);case"Speed":return Math.round(320*this.data[t][e])+"km/h";case"CFSRideHeight":case"Left front":case"Right front":case"Left rear":case"Right rear":return this.data[t][e].toFixed(2)+"mm";default:return this.data[t][e].toFixed(3)}}draw(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.drawBaseLines(),this.drawTextTitle(),this.ctx.save(),this.isTranslateCenter?(this.ctx.translate(0,(this.canvas.height-this.offsetY)/2),this.ctx.strokeStyle="rgba(255, 255, 255, 0.8)",this.ctx.moveTo(this.offsetX,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.stroke()):this.ctx.translate(0,this.canvas.height-this.offsetY),this.ctx.lineWidth=this.lineWidth;for(var t=0,e=0;e<this.data.length;e++)if(null!=this.data[e]&&null!=this.data[e]){this.ctx.strokeStyle=0==e?this.lineColorMainData:this.lineColorComparedData,this.ctx.fillStyle=0==e?this.fillColorMainData:this.fillColorComparedData,this.ctx.beginPath(),t=Math.abs(this.startMetersIndex-this.endMetersIndex),this.stepsX=(this.canvas.width-this.offsetX)/t;var i=this.stepsX,a=0;if("CFSRideHeight"==this.titleText||"Left front"==this.titleText||"Right front"==this.titleText||"Left rear"==this.titleText||"Right rear"==this.titleText)var s=((this.dataMinMax.newMax-this.dataMinMax.newMin)*(this.data[e][h]-this.dataMinMax.oldMin)/(this.dataMinMax.oldMax-this.dataMinMax.oldMin)+this.dataMinMax.newMin)*-(this.canvas.height-(this.offsetY+5));else s=this.data[e][this.startMetersIndex]*-(this.canvas.height-(this.offsetY+5));var r=0;r=this.isTranslateCenter?-(this.canvas.height-(this.offsetY+5))/2:-(this.canvas.height-(this.offsetY+5)),this.ctx.moveTo(this.offsetX+a,s);for(var n=0,h=this.startMetersIndex+1;h<this.endMetersIndex;h++)n="CFSRideHeight"==this.titleText||"Left front"==this.titleText||"Right front"==this.titleText||"Left rear"==this.titleText||"Right rear"==this.titleText?r*((this.dataMinMax.newMax-this.dataMinMax.newMin)*(this.data[e][h]-this.dataMinMax.oldMin)/(this.dataMinMax.oldMax-this.dataMinMax.oldMin)+this.dataMinMax.newMin):this.data[e][h]*r,this.ctx.lineTo(this.offsetX+i,n),null!=this.subscribeData[e]&&this.subscribeData[e][h]>0&&this.ctx.fillRect(this.offsetX+i,0,this.stepsX,this.subscribeData[e][h]*r),a=i,s=n,i+=this.stepsX;this.ctx.stroke()}for(e=0;e<this.data.length;e++)null!=this.data[e]&&null!=this.data[e]&&(this.currentIndexAt[e]=Math.round(this.xPosAt/(this.canvas.width-this.offsetX)*t)+this.startMetersIndex,this.drawCircleOnHoveredPoint(e),this.drawBoxData(e),this.smallCanvas.isCanvasValid&&(this.smallCanvas.putCurrentData(e,this.data[e][this.currentIndexAt[e]]),null!=this.subscribeData[e]&&this.smallCanvas.putSubsCurrentData(e,this.subscribeData[e][this.currentIndexAt[e]])));this.smallCanvas.isCanvasValid&&this.smallCanvas.draw(),this.ctx.restore()}}class e{constructor(t){this.LFtempL=new Float32Array(t),this.LFtempM=new Float32Array(t),this.LFtempR=new Float32Array(t),this.RFtempL=new Float32Array(t),this.RFtempM=new Float32Array(t),this.RFtempR=new Float32Array(t),this.LRtempL=new Float32Array(t),this.LRtempM=new Float32Array(t),this.LRtempR=new Float32Array(t),this.RRtempL=new Float32Array(t),this.RRtempM=new Float32Array(t),this.RRtempR=new Float32Array(t),this.index=0,this.size=0}updateIndex(){this.index+=1,this.size+=1}addLFtempL(t){this.LFtempL[this.index]=t}addLFtempM(t){this.LFtempM[this.index]=t}addLFtempR(t){this.LFtempR[this.index]=t}addRFtempL(t){this.RFtempL[this.index]=t}addRFtempM(t){this.RFtempM[this.index]=t}addRFtempR(t){this.RFtempR[this.index]=t}addLRtempL(t){this.LRtempL[this.index]=t}addLRtempM(t){this.LRtempM[this.index]=t}addLRtempR(t){this.LRtempR[this.index]=t}addRRtempL(t){this.RRtempL[this.index]=t}addRRtempM(t){this.RRtempM[this.index]=t}addRRtempR(t){this.RRtempR[this.index]=t}print(){console.log("----- Left Front -----"),console.log(this.LFtempL),console.log(this.LFtempM),console.log(this.LFtempR),console.log("----- Right Front -----"),console.log(this.RFtempL),console.log(this.RFtempM),console.log(this.RFtempR)}}class i{constructor(t){this.lapNumber=t,this.airTemp=0,this.trackTemp=0,this.windSpeed=0;var i=2e4;this.LapDistPct=new Float32Array(i),this.lapDistMeters=new Float32Array(i),this.lapDistMetersInt=new Uint32Array(i),this.lapCurrentTimeSeconds=new Float32Array(i),this.throttle=new Float32Array(i),this.brake=new Float32Array(i),this.absActive=new Uint8Array(i),this.speedKmh=new Float32Array(i),this.gear=new Float32Array(i),this.steer=new Float32Array(i),this.windDir=new Float32Array(i),this.windVel=new Float32Array(i),this.fuelLevel=new Float32Array(i),this.tires=new e(i),this.cFSRrideHeight=new Float32Array(i),this.minCFSRideHeight=9999,this.maxCFSRideHeight=-9999,this.lFRideHeight=new Float32Array(i),this.minLFRideHeight=9999,this.maxLFRideHeight=-9999,this.rFRideHeight=new Float32Array(i),this.minRFRideHeight=9999,this.maxRFRideHeight=-9999,this.lRRideHeight=new Float32Array(i),this.minLRRideHeight=9999,this.maxLRRideHeight=-9999,this.rRRideHeight=new Float32Array(i),this.minRRRideHeight=9999,this.maxRRRideHeight=-9999,this.trackCoordinate=new n(t,i),this.lapTimeStr="",this.index=0,this.size=0,this.dataLapToCompare=null}setDataLapToCompare(t){this.dataLapToCompare=t}runSyncLaps(){if(null==this.dataLapToCompare)return console.log("No data lap to compare!"),this;var t=new Array(2);t[0]=new i(1),t[1]=new i(2);for(var e=0;e<this.size;e++)for(var a=1;a<this.dataLapToCompare.size;){if(this.lapDistMetersInt[e]==this.dataLapToCompare.lapDistMetersInt[a]){var s=this.dataLapToCompare,r=Math.abs(this.lapDistMeters[e]-s.lapDistMeters[a]),n=Math.abs(this.lapDistMeters[e]-s.lapDistMeters[a+1]),h=Math.abs(this.lapDistMeters[e]-s.lapDistMeters[a-1]);n<=r&&n<=h&&(a+=1),h<=r&&h<=n&&(a-=1);var d=this.lapCurrentTimeSeconds[e]-s.lapCurrentTimeSeconds[a];t[0].addLapCurrentTimeSeconds(d),t[1].addLapCurrentTimeSeconds(0),t[0].addLapDistPct(this.LapDistPct[e]),t[0].addLapDistMeters(this.lapDistMeters[e]),t[0].addLapDistMetersInt(this.lapDistMetersInt[e]),t[0].addThrottle(this.throttle[e]),t[0].addBrake(this.brake[e]),t[0].addAbsActive(this.absActive[e]),t[0].addSpeedKmh(this.speedKmh[e]),t[0].addGear(this.gear[e]),t[0].addSteer(this.steer[e]),t[0].addWindDir(this.windDir[e]),t[0].addWindVel(this.windVel[e]),t[0].addFuelLevel(this.fuelLevel[e]),t[0].tires.addLFtempL(this.tires.LFtempL[e]),t[0].tires.addLFtempM(this.tires.LFtempM[e]),t[0].tires.addLFtempR(this.tires.LFtempR[e]),t[0].tires.addRFtempL(this.tires.RFtempL[e]),t[0].tires.addRFtempM(this.tires.RFtempM[e]),t[0].tires.addRFtempR(this.tires.RFtempR[e]),t[0].tires.addLRtempL(this.tires.LRtempL[e]),t[0].tires.addLRtempM(this.tires.LRtempM[e]),t[0].tires.addLRtempR(this.tires.LRtempR[e]),t[0].tires.addRRtempL(this.tires.RRtempL[e]),t[0].tires.addRRtempM(this.tires.RRtempM[e]),t[0].tires.addRRtempR(this.tires.RRtempR[e]),t[0].addcFSRrideHeight(this.cFSRrideHeight[e]),t[0].addFrontRideHeight(this.lFRideHeight[e],this.rFRideHeight[e]),t[0].addRearRideHeight(this.lRRideHeight[e],this.rRRideHeight[e]),t[0].trackCoordinate.addLat(this.trackCoordinate.lat[e]),t[0].trackCoordinate.addLon(this.trackCoordinate.lon[e]),t[1].addLapDistPct(s.LapDistPct[a]),t[1].addLapDistMeters(s.lapDistMeters[a]),t[1].addLapDistMetersInt(s.lapDistMetersInt[a]),t[1].addThrottle(s.throttle[a]),t[1].addBrake(s.brake[a]),t[1].addAbsActive(s.absActive[e]),t[1].addSpeedKmh(s.speedKmh[a]),t[1].addGear(s.gear[a]),t[1].addSteer(s.steer[a]),t[1].addWindDir(s.windDir[a]),t[1].addWindVel(s.windVel[a]),t[1].addFuelLevel(s.fuelLevel[a]),t[1].tires.addLFtempL(s.tires.LFtempL[e]),t[1].tires.addLFtempM(s.tires.LFtempM[e]),t[1].tires.addLFtempR(s.tires.LFtempR[e]),t[1].tires.addRFtempL(s.tires.RFtempL[e]),t[1].tires.addRFtempM(s.tires.RFtempM[e]),t[1].tires.addRFtempR(s.tires.RFtempR[e]),t[1].tires.addLRtempL(s.tires.LRtempL[e]),t[1].tires.addLRtempM(s.tires.LRtempM[e]),t[1].tires.addLRtempR(s.tires.LRtempR[e]),t[1].tires.addRRtempL(s.tires.RRtempL[e]),t[1].tires.addRRtempM(s.tires.RRtempM[e]),t[1].tires.addRRtempR(s.tires.RRtempR[e]),t[1].addcFSRrideHeight(s.cFSRrideHeight[a]),t[1].addFrontRideHeight(s.lFRideHeight[a],s.rFRideHeight[a]),t[1].addRearRideHeight(s.lRRideHeight[a],s.rRRideHeight[a]),t[1].trackCoordinate.addLat(s.trackCoordinate.lat[a]),t[1].trackCoordinate.addLon(s.trackCoordinate.lon[a]),t[0].updateIndex(),t[0].updateSize(),t[0].trackCoordinate.updateIndex(),t[0].trackCoordinate.updateSize(),t[0].tires.updateIndex(),t[1].updateIndex(),t[1].updateSize(),t[1].trackCoordinate.updateIndex(),t[1].trackCoordinate.updateSize(),t[1].tires.updateIndex();break}a++}for(e=0;e<t.length;e++)t[e].optimizeArraySize();return t}getDataLapToCompare(){return this.dataLapToCompare}getLapTimeStr(){return this.lapTimeStr}getAirTemp(){return this.airTemp}getTrackTemp(){return this.trackTemp}getLapDistPctArray(){return this.LapDistPct}getLapCurrentTimeSecondsArray(){return this.lapCurrentTimeSeconds}getLapCurrentTimeSeconds(t){return this.lapCurrentTimeSeconds[t]}getThrottleArray(){return this.throttle}getBrakeArray(){return this.brake}getAbsAcvtiveArray(){return this.absActive}getSpeedKmhArray(){return this.speedKmh}getGearArray(){return this.gear}getSteerArray(){return this.steer}getWindDirArray(){return this.windDir}getWindVelArray(){return this.windVel}getFuelLevelArray(){return this.fuelLevel}getTires(){return this.tires}getCFSRrideHeightArray(){return this.cFSRrideHeight}getLFRideHeightArray(){return this.lFRideHeight}getRFRideHeightArray(){return this.rFRideHeight}getLRRideHeightArray(){return this.lRRideHeight}getRRRideHeightArray(){return this.rRRideHeight}getLapDistMetersArray(){return this.lapDistMeters}getLapDistMetersIntArray(){return this.lapDistMetersInt}getThrottle(t){return this.throttle[t]}getLapDistMeters(t){return this.lapDistMeters[t]}getLapDistMetersInt(t){return this.lapDistMetersInt[t]}updateIndex(){this.index+=1}updateSize(){this.size+=1}optimizeArraySize(){this.LapDistPct=this.LapDistPct.slice(0,this.size),this.lapDistMeters=this.lapDistMeters.slice(0,this.size),this.lapDistMetersInt=this.lapDistMetersInt.slice(0,this.size),this.lapCurrentTimeSeconds=this.lapCurrentTimeSeconds.slice(0,this.size),this.throttle=this.throttle.slice(0,this.size),this.brake=this.brake.slice(0,this.size),this.absActive=this.absActive.slice(0,this.size),this.speedKmh=this.speedKmh.slice(0,this.size),this.gear=this.gear.slice(0,this.size),this.steer=this.steer.slice(0,this.size),this.windDir=this.windDir.slice(0,this.size),this.windVel=this.windVel.slice(0,this.size),this.fuelLevel=this.fuelLevel.slice(0,this.size),this.tires.LFtempL=this.tires.LFtempL.slice(0,this.size),this.tires.LFtempM=this.tires.LFtempM.slice(0,this.size),this.tires.LFtempR=this.tires.LFtempR.slice(0,this.size),this.tires.RFtempL=this.tires.RFtempL.slice(0,this.size),this.tires.RFtempM=this.tires.RFtempM.slice(0,this.size),this.tires.RFtempR=this.tires.RFtempR.slice(0,this.size),this.tires.LRtempL=this.tires.LRtempL.slice(0,this.size),this.tires.LRtempM=this.tires.LRtempM.slice(0,this.size),this.tires.LRtempR=this.tires.LRtempR.slice(0,this.size),this.tires.RRtempL=this.tires.RRtempL.slice(0,this.size),this.tires.RRtempM=this.tires.RRtempM.slice(0,this.size),this.tires.RRtempR=this.tires.RRtempR.slice(0,this.size),this.cFSRrideHeight=this.cFSRrideHeight.slice(0,this.size),this.lFRideHeight=this.lFRideHeight.slice(0,this.size),this.rFRideHeight=this.rFRideHeight.slice(0,this.size),this.lRRideHeight=this.lRRideHeight.slice(0,this.size),this.rRRideHeight=this.rRRideHeight.slice(0,this.size),this.trackCoordinate.lat=this.trackCoordinate.lat.slice(0,this.size),this.trackCoordinate.lon=this.trackCoordinate.lon.slice(0,this.size)}setAirTemp(t){this.airTemp=t}setTrackTemp(t){this.trackTemp=t}addLapCurrentTimeSeconds(t){this.lapCurrentTimeSeconds[this.index]=t}addLapDistPct(t){this.LapDistPct[this.index]=t}addLapDistMeters(t){this.lapDistMeters[this.index]=t}addLapDistMetersInt(t){this.lapDistMetersInt[this.index]=t}addThrottle(t){this.throttle[this.index]=t}addBrake(t){this.brake[this.index]=t}addAbsActive(t){this.absActive[this.index]=t}addSpeedKmh(t){this.speedKmh[this.index]=t}addGear(t){this.gear[this.index]=t}addSteer(t){this.steer[this.index]=t}addWindDir(t){this.windDir[this.index]=t}addWindVel(t){this.windVel[this.index]=t}addFuelLevel(t){this.fuelLevel[this.index]=t}addcFSRrideHeight(t){this.cFSRrideHeight[this.index]=t,this.minCFSRideHeight>t&&(this.minCFSRideHeight=t),this.maxCFSRideHeight<t&&(this.maxCFSRideHeight=t)}addFrontRideHeight(t,e){this.lFRideHeight[this.index]=t,this.rFRideHeight[this.index]=e,this.minLFRideHeight>t&&(this.minLFRideHeight=t),this.maxLFRideHeight<t&&(this.maxLFRideHeight=t),this.minRFRideHeight>e&&(this.minRFRideHeight=e),this.maxRFRideHeight<e&&(this.maxRFRideHeight=e)}addRearRideHeight(t,e){this.lRRideHeight[this.index]=t,this.rRRideHeight[this.index]=e,this.minLRRideHeight>t&&(this.minLRRideHeight=t),this.maxLRRideHeight<t&&(this.maxLRRideHeight=t),this.minRRRideHeight>e&&(this.minRRRideHeight=e),this.maxRRRideHeight<e&&(this.maxRRRideHeight=e)}setLapTimeSeconds(t){var e=this.lapCurrentTimeSeconds[this.size-1],i=Math.floor(e/60),a=e%60;this.lapTimeStr=i+":"+a.toFixed(4)}}class a{constructor(t,e){var i="small-"+t;if(this.isCanvasValid=!0,null!=document.getElementById(i)){this.titleText=e;var a=document.getElementById(i),s=a.clientWidth,r=a.clientHeight,n=a.parentElement;a.remove(),this.canvas=document.createElement("canvas"),this.canvas.id=i,this.canvas.className="small-canvas",this.canvas.width=s,this.canvas.height=r,n.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),this.currentData=new Array(2),this.subsCurrentData=new Array(2),this.lineColorMainData="rgb(176, 137, 245)",this.lineColorComparedData="rgb(198, 84, 4)"}else this.isCanvasValid=!1}putCurrentData(t,e){t>=2?console.log("Error: Could not add more than 2 data in small canvas!"):this.currentData[t]=e}putSubsCurrentData(t,e){t>=2?console.log("Error: Could not add more than 2 data in small canvas!"):this.subsCurrentData[t]=e}drawThrottleBrake(t){var e=0==t?38:62,i=this.canvas.height-40;this.ctx.beginPath(),this.ctx.lineWidth=2,this.ctx.strokeStyle=0==t?this.lineColorMainData:this.lineColorComparedData,this.ctx.strokeRect(e,20,20,i),this.ctx.beginPath(),this.ctx.fillStyle="Throttle"==this.titleText?"rgba(0, 165, 0, 1.0)":"rgba(165, 0, 0, 1.0)","Throttle"==this.titleText?this.ctx.fillStyle="rgba(0, 165, 0, 1.0)":this.ctx.fillStyle=1==this.subsCurrentData[t]?"rgba(255, 255, 255, 0.8)":"rgba(165, 0, 0, 1.0)",this.ctx.fillRect(e,20+i,20,-i*this.currentData[t]),this.ctx.beginPath(),this.ctx.fillStyle=0==t?this.lineColorMainData:this.lineColorComparedData,this.ctx.rect(e,this.canvas.height-18,20,15),this.ctx.fill()}draw(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);for(var t=0;t<this.currentData.length;t++)if(null!=this.currentData[t])switch(this.titleText){case"Throttle":case"Brake":this.drawThrottleBrake(t)}}}class s{constructor(t){this.file=t,this.header={},this.diskHeader={},this.varsHeader=[],this.dataLaps=null,this.data=null,this.sessionInfo=null}getHeader(){return this.header}getDiskHeader(){return this.diskHeader}getVarsHeader(){return this.varsHeader}getData(){return this.data}getDataLaps(){return this.dataLaps}getOneDataLap(t){return this.dataLaps[t]}isValid(){return null!=this.file}read(){if(this.isValid()){var t=this;return new Promise((function(e,i){var a=new FileReader;a.onloadend=function(i){t.extractData(i.target.result),e(i.target.result)},a.onerror=function(t){i(t.target.error.message)},a.readAsArrayBuffer(t.file)}))}}extractData(t){var e=new DataView(t,0,112);this.header.version=e.getUint32(0,!0),this.header.status=e.getUint32(4,!0),this.header.tick_rate=e.getUint32(8,!0),this.header.session_info_update=e.getUint32(12,!0),this.header.session_info_length=e.getUint32(16,!0),this.header.session_info_offset=e.getUint32(20,!0),this.header.num_vars=e.getUint32(24,!0),this.header.var_header_offset=e.getUint32(28,!0),this.header.num_buf=e.getUint32(32,!0),this.header.buf_len=e.getUint32(36,!0),this.header.buf_offset=e.getUint32(52,!0);var i=new DataView(t,112,32);this.diskHeader.start_date=i.getFloat64(0,!0),this.diskHeader.start_time=i.getFloat64(8,!0),this.diskHeader.end_time=i.getFloat64(16,!0),this.diskHeader.lap_count=i.getUint32(24,!0),this.diskHeader.record_count=i.getUint32(28,!0);for(var a=new DataView(t,this.header.var_header_offset,144*this.header.num_vars),s=0,r=0;r<this.header.num_vars;r++)this.varsHeader.push({type:a.getUint32(s+0,!0),offset:a.getUint32(s+4,!0),count:a.getUint32(s+8,!0),count_as_time:a.getUint8(s+12,!0),name:this.convertToString(a,s+16,s+16+32),desc:null,unit:null}),s+=144;this.sessionInfo=new Uint8Array(t.slice(this.header.session_info_offset,this.header.session_info_offset+this.header.session_info_length)),this.data=new Uint8Array(t.slice(this.header.buf_offset)),this.loadDataLaps()}print(){console.log(this.header),console.log(this.diskHeader),console.log(this.varsHeader),console.log("Data Length:",this.data.length)}convertToString(t,e,i){for(var a="",s=i-e,r=0;r<s;r++){a+=0==t.getUint8(r+e)?"":String.fromCharCode(t.getUint8(r+e))}return a}loadDataLaps(){for(var t=new Array(this.diskHeader.lap_count),e=1;e<=this.diskHeader.lap_count;e++)t[e-1]=new i(e);for(var a=this.data.length/this.header.buf_len,s=0,r=this.getHeaderData("Lap",0).content,n=0,h=0,d=0,l=0;l<a;l++){if((s=this.getHeaderData("Lap",l).content)!=r){if(t[d].setLapTimeSeconds(0),t[d].optimizeArraySize(),h+1>=this.diskHeader.lap_count)break;h++}var o=this.getHeaderData("LapDistPct",l).content,c=parseFloat(this.getHeaderData("LapDist",l).content),g=parseInt(c),p=this.getHeaderData("AirTemp",l).content.toFixed(1),m=this.getHeaderData("TrackTemp",l).content.toFixed(1),R=0;g>180&&(R=parseFloat(this.getHeaderData("LapCurrentLapTime",l).content));var x=this.getHeaderData("Throttle",l).content,L=this.getHeaderData("Brake",l).content,u=this.getHeaderData("BrakeABSactive",l).content,v=(3600*this.getHeaderData("Speed",l).content/1e3/320).toFixed(3),f=(this.getHeaderData("Gear",l).content/8).toFixed(1),M=this.getHeaderData("SteeringWheelAngle",l).content,F=this.getHeaderData("WindDir",l).content,C=3.6*this.getHeaderData("WindVel",l).content,w=this.getHeaderData("FuelLevel",l).content,A=1e3*this.getHeaderData("CFSRrideHeight",l).content,D=1e3*this.getHeaderData("LFrideHeight",l).content,y=1e3*this.getHeaderData("RFrideHeight",l).content,H=1e3*this.getHeaderData("LRrideHeight",l).content,T=1e3*this.getHeaderData("RRrideHeight",l).content,S=this.getHeaderData("Lat",l).content,k=this.getHeaderData("Lon",l).content;t[h].setAirTemp(p),t[h].setTrackTemp(m),t[h].addLapCurrentTimeSeconds(R),t[h].addLapDistPct(o),t[h].addLapDistMeters(c),t[h].addLapDistMetersInt(g),t[h].addThrottle(x),t[h].addBrake(L),t[h].addAbsActive(u),t[h].addSpeedKmh(v),0==f&&(f=n),t[h].addGear(f),t[h].addSteer(M),t[h].addWindDir(F),t[h].addWindVel(C),t[h].addFuelLevel(w),t[h].tires.addLFtempL(this.getHeaderData("LFtempL",l).content),t[h].tires.addLFtempM(this.getHeaderData("LFtempM",l).content),t[h].tires.addLFtempR(this.getHeaderData("LFtempR",l).content),t[h].tires.addRFtempL(this.getHeaderData("RFtempL",l).content),t[h].tires.addRFtempM(this.getHeaderData("RFtempM",l).content),t[h].tires.addRFtempR(this.getHeaderData("RFtempR",l).content),t[h].tires.addLRtempL(this.getHeaderData("LRtempL",l).content),t[h].tires.addLRtempM(this.getHeaderData("LRtempM",l).content),t[h].tires.addLRtempR(this.getHeaderData("LRtempR",l).content),t[h].tires.addRRtempL(this.getHeaderData("RRtempL",l).content),t[h].tires.addRRtempM(this.getHeaderData("RRtempM",l).content),t[h].tires.addRRtempR(this.getHeaderData("RRtempR",l).content),t[h].addcFSRrideHeight(A),t[h].addFrontRideHeight(D,y),t[h].addRearRideHeight(H,T),t[h].trackCoordinate.addLat(S),t[h].trackCoordinate.addLon(k),t[h].updateSize(),t[h].updateIndex(),t[h].trackCoordinate.updateSize(),t[h].trackCoordinate.updateIndex(),t[h].tires.updateIndex(),r=s,d=h,n=f}t[h].setLapTimeSeconds(0),t[h].optimizeArraySize(),this.dataLaps=t}getHeaderData(t,e){for(var i=null,a=0;a<this.varsHeader.length;a++)if(this.varsHeader[a].name==t){i=this.varsHeader[a];break}if(null==i)return i={content:0};var s=e*this.header.buf_len+i.offset;switch(i.type){case 0:i.content_type="string";var r=this.data.slice(s,s+8),n="";for(a=0;a<8;a++){n+=0==r[a]?"":String.fromCharCode(r[a])}i.content=n,8;break;case 1:i.content_type="boolean";r=this.data.slice(s,s+1);i.content=255&r,1;break;case 2:i.content_type="int32";var h=4294967295&((r=this.data.slice(s,s+4))[0]|r[1]<<8|r[2]<<16|r[3]<<24);i.content=h,4;break;case 3:h=4294967295&((r=this.data.slice(s,s+4))[0]|r[1]<<8|r[2]<<16|r[3]<<24);i.content_type="uint32",i.content=h,4;break;case 4:i.content_type="float32";r=this.data.slice(s,s+4);var d=new ArrayBuffer(4);(l=new DataView(d)).setUint8(0,r[0]),l.setUint8(1,r[1]),l.setUint8(2,r[2]),l.setUint8(3,r[3]),i.content=l.getFloat32(0,!0),4;break;case 5:i.content_type="float64";var l;r=this.data.slice(s,s+8),d=new ArrayBuffer(8);(l=new DataView(d)).setInt8(0,r[0]),l.setInt8(1,r[1]),l.setInt8(2,r[2]),l.setInt8(3,r[3]),l.setInt8(4,r[4]),l.setInt8(5,r[5]),l.setInt8(6,r[6]),l.setInt8(7,r[7]),i.content=l.getFloat64(0,!0),8;break;default:console.log("default")}return i}printSessionInfo(){for(var t=0,e="";t<this.sessionInfo.length;)e+=String.fromCharCode(this.sessionInfo[t]),t++;console.log(e)}}class r{constructor(){var t="track-canvas",e=document.getElementById(t),i=e.clientWidth,a=e.clientHeight,s=e.parentElement;e.remove(),this.canvas=document.createElement("canvas"),this.canvas.className=e.className,this.canvas.id=t,this.canvas.width=i,this.canvas.height=a,s.appendChild(this.canvas),this.widthForTrack=this.canvas.width-100,this.heightForTrack=this.canvas.height-80,this.ctx=this.canvas.getContext("2d"),this.currentIndexAt=0,this.trackCoordinates=new Array(2),this.steerAngles=new Array(2),this.windDirs=new Array(2),this.LFtemp={left:new Array(2),middle:new Array(2),right:new Array(2)},this.RFtemp={left:new Array(2),middle:new Array(2),right:new Array(2)},this.LRtemp={left:new Array(2),middle:new Array(2),right:new Array(2)},this.RRtemp={left:new Array(2),middle:new Array(2),right:new Array(2)},this.steerImgs=new Array(2),this.steerImgs[0]=document.getElementById("steeringWheel1"),this.steerImgs[1]=document.getElementById("steeringWheel2"),this.windDirImgs=new Array(2),this.windDirImgs[0]=document.getElementById("windDir1"),this.windDirImgs[1]=document.getElementById("windDir2"),this.compassImg=document.getElementById("arrow-compass"),this.xTranslate=0,this.yTranslate=0,this.zoom=1,this.trackLineColorMain="rgb(72, 109, 232)",this.trackLineColorCompared="rgb(197, 83, 5)",this.drawTestLines(),this.activeMoveTrack()}setZoom(t){this.zoom=t}setTranslate(t,e){this.xTranslate=t,this.yTranslate=e}setTrackCoordinates(t,e){t>=2?console.log("Error: You Cannot Set More Than 2 data Laps!"):this.trackCoordinates[t]=e}setSteerAngles(t,e){t>=2?console.log("Error: You Cannot Set More Than 2 data Laps!"):this.steerAngles[t]=e}setWindDirs(t,e){t>=2?console.log("Error: You Cannot Set More Than 2 data Laps!"):this.windDirs[t]=e}setTiresFrontTemp(t,e,i,a,s,r,n){this.LFtemp.left[t]=e,this.LFtemp.middle[t]=i,this.LFtemp.right[t]=a,this.RFtemp.left[t]=s,this.RFtemp.middle[t]=r,this.RFtemp.right[t]=n}setTiresRearTemp(t,e,i,a,s,r,n){this.LRtemp.left[t]=e,this.LRtemp.middle[t]=i,this.LRtemp.right[t]=a,this.RRtemp.left[t]=s,this.RRtemp.middle[t]=r,this.RRtemp.right[t]=n}updateCurrentIndexAt(t){this.currentIndexAt=t,this.draw()}activeMoveTrack(){var t=this,e=!1,i=0,a=0;this.canvas.addEventListener("mousedown",(function(s){null==t.trackCoordinates[0]&&null==t.trackCoordinates[1]||(i=s.pageX-t.xTranslate,a=s.pageY-t.yTranslate,e=!0)})),this.canvas.addEventListener("mousemove",(function(s){e&&(t.xTranslate=s.pageX-i,t.yTranslate=s.pageY-a,t.draw())})),this.canvas.addEventListener("mouseup",(function(){e&&(e=!1)})),this.canvas.addEventListener("mouseout",(function(){e&&(e=!1)}));this.canvas.addEventListener("wheel",(function(e){if(null!=t.trackCoordinates[0]||null!=t.trackCoordinates[1]){e.preventDefault();var i=1;i="Up"==(e.deltaY>0?"Down":"Up")?t.zoom+.1:t.zoom-.1,t.zoom=i,t.draw()}}))}convertLatLonToCanvas(t,e){var i=this.trackCoordinates[t];return{x:(i.lon[e]-i.minLon)*(this.widthForTrack/(i.maxLon-i.minLon)),y:this.heightForTrack-(i.lat[e]-i.minLat)*(this.heightForTrack/(i.maxLat-i.minLat))}}drawTestLines(){this.ctx.strokeStyle="rgba(255, 255, 255, 1.0)",this.ctx.lineWidth=1,this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.stroke()}drawCircleOnTrack(){this.ctx.beginPath(),this.ctx.fillStyle="rgb(255, 255, 255)";var t=null!=this.trackCoordinates[0]?0:1,e=this.convertLatLonToCanvas(t,this.currentIndexAt);this.ctx.arc(e.x,e.y,4,0,2*Math.PI),this.ctx.fill()}drawSteerAngles(){if(null!=this.steerAngles[0]||null!=this.steerAngles[1])for(var t=10,e=this.canvas.width-90,i=0;i<this.steerAngles.length;i++)null!=this.steerAngles[i]&&(t=t+80*i+5,this.ctx.beginPath(),this.ctx.save(),this.ctx.translate(e+40,t+40),this.ctx.rotate(-this.steerAngles[i][this.currentIndexAt]),this.ctx.drawImage(this.steerImgs[i],-40,-40,80,80),this.ctx.restore(),this.ctx.fillStyle=0==i?"rgb(31, 7, 102)":"rgb(102, 2, 2)",this.ctx.arc(e+40,t+40,8,0,2*Math.PI),this.ctx.fill())}drawWindDir(){if(null!=this.steerAngles[0]||null!=this.steerAngles[1])for(var t=15,e=0;e<this.windDirs.length;e++)null!=this.windDirs[e]&&(t+=0==e?30:80,this.ctx.beginPath(),this.ctx.save(),this.ctx.translate(50,t+15),this.ctx.drawImage(this.compassImg,-38,-32,70,70),this.ctx.rotate(this.windDirs[e][this.currentIndexAt]),this.ctx.drawImage(this.windDirImgs[e],-15,-15,30,30),this.ctx.restore())}drawTires(){this.ctx.beginPath(),this.ctx.fillStyle="rgba(10, 255, 10, 1.0)",this.ctx.fillText("Tires Will Be Added Soon",10,this.canvas.height-160),this.ctx.fillStyle="rgba(255, 255, 255, 1.0)";var t=20,e=50;this.ctx.beginPath(),this.ctx.fillRect(t,this.canvas.height-150,8,e),this.ctx.fillRect(t+8+2,this.canvas.height-150,8,e),this.ctx.fillRect(t+16+4,this.canvas.height-150,8,e),t+=34,this.ctx.fillRect(t,this.canvas.height-150,8,e),this.ctx.fillRect(t+8+2,this.canvas.height-150,8,e),this.ctx.fillRect(t+16+4,this.canvas.height-150,8,e)}draw(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.save(),this.ctx.translate(this.xTranslate,this.yTranslate),this.ctx.scale(this.zoom,this.zoom),this.ctx.lineWidth=1;for(let r=0;r<this.trackCoordinates.length;r++)if(null!=this.trackCoordinates[r]&&null!=this.trackCoordinates[r]){var t=this.trackCoordinates[r],e=this.convertLatLonToCanvas(r,0);this.ctx.strokeStyle=0==r?this.trackLineColorMain:this.trackLineColorCompared;var i=e.x,a=e.y;this.ctx.beginPath();for(var s=1;s<t.size;s++)e=this.convertLatLonToCanvas(r,s),this.ctx.moveTo(i,a),i=e.x,a=e.y,e.x*this.zoom-5+this.xTranslate>this.canvas.width||e.x*this.zoom+this.xTranslate<-5||e.y*this.zoom-5+this.yTranslate>this.canvas.height||e.y*this.zoom+this.yTranslate<-5||this.ctx.lineTo(e.x,e.y);this.ctx.stroke()}this.drawCircleOnTrack(),this.ctx.restore(),this.drawSteerAngles(),this.drawWindDir(),this.drawTires()}}class n{constructor(t,e){this.lapNum=t,this.lat=new Float32Array(e),this.lon=new Float32Array(e),this.minLat=9999,this.maxLat=-9999,this.minLon=9999,this.maxLon=-9999,this.size=0,this.index=0}updateSize(){this.size+=1}updateIndex(){this.index+=1}addLat(t){this.lat[this.index]=t,this.minLat>t&&(this.minLat=t),this.maxLat<t&&(this.maxLat=t)}addLon(t){this.lon[this.index]=t,this.minLon>t&&(this.minLon=t),this.maxLon<t&&(this.maxLon=t)}getLatArray(){return this.lat}getLonArray(){return this.lon}}var h=document.getElementById("form_data");null==h&&console.log("Error: Could not find the form to upload");var d=document.querySelector(".loading_div");function l(){d.style.display="none"}var o=new Array(2),c=new Array(10),g=new class{constructor(){this.allCanvases=[],this.TrackCanvas=new r,this.isMouseDown=!1,this.xData=new Array(2),this.fuelLevels=new Array(2),this.windVel=new Array(2),this.filesInfoElements=[document.querySelectorAll(".file1Info"),document.querySelectorAll(".file2Info")],this.MAX_SELECTION=200}addCanvas(t){this.allCanvases.push(t)}clearAllCanvas(){this.allCanvases=[],this.TrackCanvas=new r}getTrackCanvas(){return this.TrackCanvas}setXData(t,e){this.xData[t]=e}setFuelLevel(t,e){this.fuelLevels[t]=e}setWindVel(t,e){this.windVel[t]=e}activeOnMouseMove(){var t=this;for(let e=0;e<this.allCanvases.length;e++)this.allCanvases[e].getCanvas().onmousemove=function(e){for(let i=0;i<t.allCanvases.length;i++)t.canvasOnMouseMove(e,t.allCanvases[i],t)},this.allCanvases[e].getCanvas().onmousedown=function(i){for(let a=0;a<t.allCanvases.length;a++)t.canvasOnMouseDown(i,t.allCanvases[e])}}canvasOnMouseMove(t,e,i){if(e.xPosAt=t.offsetX-e.getOffsetX(),!(e.xPosAt<0||e.xPosAt+e.getOffsetX()>=e.canvas.width)){e.draw(),e.ctx.strokeStyle="rgba(255, 255, 255, 1.0)",e.ctx.lineWidth=1,e.ctx.beginPath(),e.ctx.moveTo(t.offsetX,0),e.ctx.lineTo(t.offsetX,e.getCanvas().height-e.getOffsetY()),e.ctx.stroke(),e.ctx.fillStyle="rgba(255, 255, 255, 1.0)";var a=null!=e.getCurrentIndexAt(0)?e.getCurrentIndexAt(0):e.getCurrentIndexAt(1),s=i.xData[0][a];e.ctx.font="bold 10px Arial",e.ctx.fillStyle="rgba(255, 255, 255, 1.0)",e.ctx.fillText(s+"m",t.offsetX-10,e.getCanvas().height-10),i.TrackCanvas.updateCurrentIndexAt(a),null!=e.getCurrentIndexAt(0)&&null!=i.fuelLevels[0]&&(i.filesInfoElements[0][2].textContent=parseFloat(i.windVel[0][e.getCurrentIndexAt(0)]).toFixed(1)+"km/h",i.filesInfoElements[0][3].textContent=parseFloat(i.fuelLevels[0][e.getCurrentIndexAt(0)]).toFixed(2)+"L"),null!=e.getCurrentIndexAt(1)&&null!=i.fuelLevels[1]&&(i.filesInfoElements[1][2].textContent=parseFloat(i.windVel[1][e.getCurrentIndexAt(1)]).toFixed(1)+"km/h",i.filesInfoElements[1][3].textContent=parseFloat(i.fuelLevels[1][e.getCurrentIndexAt(1)]).toFixed(2)+"L")}}canvasOnMouseDown(t,e){var i=t.offsetX,a=null!=e.getCurrentIndexAt(0)?e.getCurrentIndexAt(0):e.getCurrentIndexAt(1),s=0;i-e.getOffsetX()<0&&(i=0),this.isMouseDown=!0;var r=this;window.onmousemove=function(t){if(r.isMouseDown&&!(t.offsetX-e.getOffsetX()<0)){var a=t.offsetX-i;s=null!=e.getCurrentIndexAt(0)?e.getCurrentIndexAt(0):e.getCurrentIndexAt(1),r.highlightsSelectedPart(i,a)}},window.onmouseup=function(){if(r.isMouseDown){if(a+s!=a&&Math.abs(a-s)>r.MAX_SELECTION){if(a>s){var t=a;a=s,s=t}for(var e=0;e<r.allCanvases.length;e++)r.allCanvases[e].setStartEndIndex(a,s)}r.isMouseDown=!1}}}highlightsSelectedPart(t,e){for(var i=0;i<this.allCanvases.length;i++){var a=this.allCanvases[i].ctx;a.beginPath(),a.fillStyle="rgba(255, 255, 255, 0.2)",a.fillRect(t,0,e,this.allCanvases[i].getCanvas().height)}}},p={lap1:-1,lap2:-1};function m(){c[0]=new t("delta","Delta"),c[0].setIsTranslateCenter(!0),c[1]=new t("throttle","Throttle"),c[2]=new t("brake","Brake"),c[3]=new t("speed","Speed"),c[4]=new t("gear","Gear"),c[5]=new t("CFSRideHeight","CFSRideHeight"),c[6]=new t("LFRideHeight","Left front"),c[7]=new t("RFRideHeight","Right front"),c[8]=new t("LRRideHeight","Left rear"),c[9]=new t("RRRideHeight","Right rear"),g.clearAllCanvas();for(var e=0;e<c.length;e++)c[e].clear(),g.addCanvas(c[e])}function R(t){for(var e=document.querySelectorAll(t),i=0;i<e.length;i++)e[i].className=""}function x(t){m();var e=parseInt(t.parentElement.getAttribute("data-file-index")),i=parseInt(t.getAttribute("data-lap"));0==e?(R(".ul-laps1 li"),p.lap1==i?p.lap1=-1:(p.lap1=i,t.className="selectedFile1")):(R(".ul-laps2 li"),p.lap2==i?p.lap2=-1:(p.lap2=i,t.className="selectedFile2")),-1!=p.lap1||-1!=p.lap2?(!function(){if(o[0].isValid()&&-1!=p.lap1&&-1==p.lap2){var t=o[0].getOneDataLap(p.lap1),e=new Float32Array(t.size);c[0].setLap(0,e),c[0].draw(),c[1].setLap(0,t.getThrottleArray()),c[1].draw(),c[2].setLap(0,t.getBrakeArray()),c[2].setSubscribeData(0,t.getAbsAcvtiveArray()),c[2].draw(),c[3].setLap(0,t.getSpeedKmhArray()),c[3].draw(),c[4].setLap(0,t.getGearArray()),c[4].draw(),c[5].boxWidth=54,c[5].setLap(0,t.getCFSRrideHeightArray()),c[5].setMinMaxData(t.minCFSRideHeight,t.maxCFSRideHeight,0,1),c[5].draw(),c[6].boxWidth=54,c[6].setLap(0,t.getLFRideHeightArray()),c[6].setMinMaxData(t.minLFRideHeight,t.maxLFRideHeight,0,1),c[6].draw(),c[7].boxWidth=54,c[7].setLap(0,t.getRFRideHeightArray()),c[7].setMinMaxData(t.minRFRideHeight,t.maxRFRideHeight,0,1),c[7].draw(),c[8].boxWidth=54,c[8].setLap(0,t.getLRRideHeightArray()),c[8].setMinMaxData(t.minLRRideHeight,t.maxLRRideHeight,0,1),c[8].draw(),c[9].boxWidth=54,c[9].setLap(0,t.getRRRideHeightArray()),c[9].setMinMaxData(t.minRRRideHeight,t.maxRRRideHeight,0,1),c[9].draw(),g.setXData(0,t.getLapDistMetersIntArray()),g.getTrackCanvas().setTrackCoordinates(0,t.trackCoordinate),g.getTrackCanvas().setSteerAngles(0,t.getSteerArray()),g.getTrackCanvas().setWindDirs(0,t.getWindDirArray()),g.getTrackCanvas().setTiresFrontTemp(0,t.tires.LFtempL,t.tires.LFtempM,t.tires.LFtempR,t.tires.RFtempL,t.tires.RFtempM,t.tires.RFtempR),g.getTrackCanvas().setTiresRearTemp(0,t.tires.LRtempL,t.tires.LRtempM,t.tires.LRtempR,t.tires.RRtempL,t.tires.RRtempM,t.tires.RRtempR),g.setWindVel(0,t.getWindVelArray()),g.setFuelLevel(0,t.getFuelLevelArray()),g.getTrackCanvas().draw(),L(0,t.airTemp,t.trackTemp,t.windVel[0],t.fuelLevel[0])}if(o[1].isValid()&&-1!=p.lap2&&-1==p.lap1){var i=o[1].getOneDataLap(p.lap2);e=new Float32Array(i.size);c[0].setLap(1,e),c[0].draw(),c[1].setLap(1,i.getThrottleArray()),c[1].draw(),c[2].setLap(1,i.getBrakeArray()),c[2].setSubscribeData(1,i.getAbsAcvtiveArray()),c[2].draw(),c[3].setLap(1,i.getSpeedKmhArray()),c[3].draw(),c[4].setLap(1,i.getGearArray()),c[4].draw(),c[5].boxWidth=54,c[5].setLap(1,i.getCFSRrideHeightArray()),c[5].setMinMaxData(i.minCFSRideHeight,i.maxCFSRideHeight,0,1),c[5].draw(),c[6].boxWidth=54,c[6].setLap(1,i.getLFRideHeightArray()),c[6].setMinMaxData(i.minLFRideHeight,i.maxLFRideHeight,0,1),c[6].draw(),c[7].boxWidth=54,c[7].setLap(1,i.getRFRideHeightArray()),c[7].setMinMaxData(i.minRFRideHeight,i.maxRFRideHeight,0,1),c[7].draw(),c[8].boxWidth=54,c[8].setLap(1,i.getLRRideHeightArray()),c[8].setMinMaxData(i.minLRRideHeight,i.maxLRRideHeight,0,1),c[8].draw(),c[9].boxWidth=54,c[9].setLap(1,i.getRRRideHeightArray()),c[9].setMinMaxData(i.minRRRideHeight,i.maxRRRideHeight,0,1),c[9].draw(),g.setXData(0,i.getLapDistMetersIntArray()),g.getTrackCanvas().setTrackCoordinates(1,i.trackCoordinate),g.getTrackCanvas().setSteerAngles(1,i.getSteerArray()),g.getTrackCanvas().setWindDirs(1,i.getWindDirArray()),g.setWindVel(1,i.getWindVelArray()),g.setFuelLevel(1,i.getFuelLevelArray()),g.getTrackCanvas().draw(),L(1,i.airTemp,i.trackTemp,i.windVel[0],i.fuelLevel[0])}if(o[0].isValid()&&o[1].isValid()&&p.lap1>-1&&p.lap2>-1){t=o[0].getOneDataLap(p.lap1),i=o[1].getOneDataLap(p.lap2);t.setDataLapToCompare(i);var a=t.runSyncLaps();c[0].setLap(0,a[0].getLapCurrentTimeSecondsArray()),c[0].draw(),c[1].setLap(0,a[0].getThrottleArray()),c[1].setLap(1,a[1].getThrottleArray()),c[1].draw(),c[2].setLap(0,a[0].getBrakeArray()),c[2].setLap(1,a[1].getBrakeArray()),c[2].setSubscribeData(0,a[0].getAbsAcvtiveArray()),c[2].setSubscribeData(1,a[1].getAbsAcvtiveArray()),c[2].draw(),c[3].setLap(0,a[0].getSpeedKmhArray()),c[3].setLap(1,a[1].getSpeedKmhArray()),c[3].draw(),c[4].setLap(0,a[0].getGearArray()),c[4].setLap(1,a[1].getGearArray()),c[4].draw(),c[5].boxWidth=54,c[5].setLap(0,a[0].getCFSRrideHeightArray()),c[5].setLap(1,a[1].getCFSRrideHeightArray()),c[5].setMinMaxData(a[0].minCFSRideHeight,a[0].maxCFSRideHeight,0,1),c[5].setMinMaxData(a[1].minCFSRideHeight,a[1].maxCFSRideHeight,0,1),c[5].draw(),c[6].boxWidth=54,c[6].setLap(0,a[0].getLFRideHeightArray()),c[6].setLap(1,a[1].getLFRideHeightArray()),c[6].setMinMaxData(a[0].minLFRideHeight,a[0].maxLFRideHeight,0,1),c[6].setMinMaxData(a[1].minLFRideHeight,a[1].maxLFRideHeight,0,1),c[6].draw(),c[7].boxWidth=54,c[7].setLap(0,a[0].getRFRideHeightArray()),c[7].setLap(1,a[1].getRFRideHeightArray()),c[7].setMinMaxData(a[0].minRFRideHeight,a[0].maxRFRideHeight,0,1),c[7].setMinMaxData(a[1].minRFRideHeight,a[1].maxRFRideHeight,0,1),c[7].draw(),c[8].boxWidth=54,c[8].setLap(0,a[0].getLRRideHeightArray()),c[8].setLap(1,a[1].getLRRideHeightArray()),c[8].setMinMaxData(a[0].minLRRideHeight,a[0].maxLRRideHeight,0,1),c[8].setMinMaxData(a[1].minLRRideHeight,a[1].maxLRRideHeight,0,1),c[8].draw(),c[9].boxWidth=54,c[9].setLap(0,a[0].getRRRideHeightArray()),c[9].setLap(1,a[1].getRRRideHeightArray()),c[9].setMinMaxData(a[0].minRRRideHeight,a[0].maxRRRideHeight,0,1),c[9].setMinMaxData(a[1].minRRRideHeight,a[1].maxRRRideHeight,0,1),c[9].draw(),g.setXData(0,a[0].getLapDistMetersIntArray()),g.getTrackCanvas().setTrackCoordinates(0,a[0].trackCoordinate),g.getTrackCanvas().setTrackCoordinates(1,a[1].trackCoordinate),g.getTrackCanvas().setSteerAngles(0,a[0].getSteerArray()),g.getTrackCanvas().setSteerAngles(1,a[1].getSteerArray()),g.getTrackCanvas().setWindDirs(0,a[0].getWindDirArray()),g.getTrackCanvas().setWindDirs(1,a[1].getWindDirArray()),g.setWindVel(0,a[0].getWindVelArray()),g.setWindVel(1,a[1].getWindVelArray()),g.setFuelLevel(0,a[0].getFuelLevelArray()),g.setFuelLevel(1,a[1].getFuelLevelArray()),g.getTrackCanvas().draw(),L(0,t.airTemp,t.trackTemp,a[0].windVel[0],a[0].fuelLevel[0]),L(1,i.airTemp,i.trackTemp,a[1].windVel[0],a[1].fuelLevel[0])}}(),g.activeOnMouseMove()):console.log("Choose The Laps")}function L(t,e,i,a,s){var r=[document.querySelectorAll(".file1Info"),document.querySelectorAll(".file2Info")];if(null==o[t])return r[t][0].textContent="0c",r[t][1].textContent="0c",r[t][2].textContent="0km/h",void(r[t][3].textContent="0L");r[t][0].textContent=e+"c",r[t][1].textContent=i+"c",r[t][2].textContent=parseFloat(a).toFixed(1)+"km/h",r[t][3].textContent=parseFloat(s).toFixed(2)+"L"}function u(t){if(null==t)return null;for(var e=[],i=0;i<t.length;i++)e.push(t[i].getLapTimeStr());return e}h.addEventListener("submit",(async function(t){if(t.preventDefault(),function(){d.style.display="block"}(),(o=new Array(2))[0]=new s(h.file1.files[0]),o[1]=new s(h.file2.files[0]),!o[0].isValid()&&!o[1].isValid())return console.log("no files"),void setTimeout(l,1e3);p.lap1=-1,p.lap2=-1,o[0].isValid()&&await o[0].read();o[1].isValid()&&await o[1].read();setTimeout((function(){var t,e,i;m(),t=o[0].getDataLaps(),e=o[1].getDataLaps(),(i=new Array(2))[0]=u(t),i[1]=u(e),function(t){var e=document.querySelector(".ul-laps1");if(e.innerHTML="",null!=t[0])for(var i=0;i<t[0].length;i++)e.innerHTML+="<li data-lap='"+i+"'>"+t[0][i]+"</li>";var a=document.querySelector(".ul-laps2");if(a.innerHTML="",null!=t[1])for(i=0;i<t[1].length;i++)a.innerHTML+="<li data-lap='"+i+"'>"+t[1][i]+"</li>";var s=document.querySelectorAll(".ul-laps1 li"),r=document.querySelectorAll(".ul-laps2 li");for(let t=0;t<s.length;t++)s[t].addEventListener("click",(function(){x(s[t])}));for(let t=0;t<r.length;t++)r[t].addEventListener("click",(function(){x(r[t])}));l()}(i)}),100)})),document.getElementById("controller-zoom-out").onclick=function(){for(var t=0;t<g.allCanvases.length;t++)for(var e=0;e<g.allCanvases[t].data.length;e++)null!=g.allCanvases[t].data[e]&&g.allCanvases[t].setStartEndIndex(0,g.allCanvases[t].data[e].length);g.getTrackCanvas().setZoom(1),g.getTrackCanvas().setTranslate(0,0),g.getTrackCanvas().draw()};